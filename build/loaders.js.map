{"version":3,"sources":["../source/loaders.js"],"names":["find_style_loaders","parse_loader","stringify_loader","is_style_loader","normalize_loaders","configuration","style_loaders","module","rules","loader","loaders","Error","indexOf","split","style_loader","filter","push","name","query","substring","parse","result","stringify","lastIndexOf","inspect"],"mappings":"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","file":"loaders.js","sourcesContent":["import util from 'util'\r\nimport querystring from 'querystring'\r\n\r\nimport { is_object, ends_with } from './helpers'\r\n\r\n// Finds module loaders with `style-loader`\r\nexport function find_style_loaders(configuration)\r\n{\r\n\tconst style_loaders = []\r\n\r\n\tfor (let loader of configuration.module.rules)\r\n\t{\r\n\t\tlet loaders = loader.loaders\r\n\r\n\t\t// convert `loader` to `loaders` for convenience\r\n\t\tif (!loader.loaders)\r\n\t\t{\r\n\t\t\tif (!loader.loader)\r\n\t\t\t{\r\n\t\t\t\tthrow new Error('No webpack loader specified for this `module.loaders` element')\r\n\t\t\t}\r\n\r\n\t\t\t// Don't mess with ExtractTextPlugin at all\r\n\t\t\t// (even though it has `style` loader,\r\n\t\t\t//  it has its own ways)\r\n\t\t\tif (loader.loader.indexOf('extract-text-webpack-plugin/loader.js') >= 0)\r\n\t\t\t{\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\r\n\t\t\tif (loader.loader.indexOf('!') >= 0)\r\n\t\t\t{\r\n\t\t\t\t// Replace `loader` with the corresponding `loaders`\r\n\t\t\t\tloader.loaders = loader.loader.split('!')\r\n\t\t\t\tdelete loader.loader\r\n\t\t\t}\r\n\r\n\t\t\t// if (loader.query)\r\n\t\t\t// {\r\n\t\t\t// \tloader.loaders[0] += '?' + querystring.stringify(loader.query)\r\n\t\t\t// \tdelete loader.query\r\n\t\t\t// }\r\n\t\t}\r\n\r\n\t\t// Check if this module loader has a `style-loader`\r\n\t\tconst style_loader = (loader.loaders || loader.loader.split('!')).filter(is_style_loader)[0]\r\n\t\tif (style_loader)\r\n\t\t{\r\n\t\t\tstyle_loaders.push(loader)\r\n\t\t}\r\n\t}\r\n\r\n\treturn style_loaders\r\n}\r\n\r\n// Converts loader string into loader info structure\r\nexport function parse_loader(loader)\r\n{\r\n\tlet name\r\n\tlet query\r\n\r\n\tif (is_object(loader))\r\n\t{\r\n\t\tname = loader.loader\r\n\t\tquery = loader.query\r\n\t}\r\n\telse\r\n\t{\r\n\t\tname = loader\r\n\r\n\t\tif (name.indexOf('?') >= 0)\r\n\t\t{\r\n\t\t\tname = name.substring(0, name.indexOf('?'))\r\n\t\t\tquery = querystring.parse(loader.substring(loader.indexOf('?') + 1))\r\n\t\t}\r\n\t}\r\n\r\n\tconst result =\r\n\t{\r\n\t\tname,\r\n\t\tquery\r\n\t}\r\n\r\n\treturn result\r\n}\r\n\r\n// Converts loader info into a string\r\nexport function stringify_loader(loader)\r\n{\r\n\treturn loader.name + (loader.query ? '?' + querystring.stringify(loader.query) : '')\r\n}\r\n\r\n// Checks if the passed loader is `style-loader`\r\nexport function is_style_loader(loader)\r\n{\r\n\tlet { name } = parse_loader(loader)\r\n\r\n\tif (ends_with(name, '-loader'))\r\n\t{\r\n\t\tname = name.substring(0, name.lastIndexOf('-loader'))\r\n\t}\r\n\r\n\treturn name === 'style'\r\n}\r\n\r\n// Converts `loader` to `loaders`\r\nexport function normalize_loaders(loader)\r\n{\r\n\tif (!loader.loaders)\r\n\t{\r\n\t\tif (!loader.loader)\r\n\t\t{\r\n\t\t\tthrow new Error(`Neither \"loaders\" not \"loader\" are present inside a module loader: ${util.inspect(loader)}`)\r\n\t\t}\r\n\r\n\t\tif (loader.query)\r\n\t\t{\r\n\t\t\tthrow new Error(`Unable to normalize a module loader with a \"query\" object: ${util.inspect(loader)}`)\r\n\t\t}\r\n\r\n\t\tloader.loaders = loader.loader.split('!')\r\n\t\tdelete loader.loader\r\n\t}\r\n}\r\n"]}